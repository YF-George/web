/*
  nav.css
  中文註解：
  - 功能：導覽列內部項目（link / list / actions）的樣式，包含 active 狀態與使用者區塊的小樣式。
  - 主要 selectors：`.nav-list`、`.nav-link`、`.nav-actions`、`.nav-user`、`.nav-role`。
  - 注意事項：當視覺主題變更（深色模式 / 色票）時，請在此調整 active / hover 顏色。
*/

.nav-list {
	display: flex;
	gap: 0.5rem;
	list-style: none;
	margin: 0;
	padding: 0;
}

.nav-link {
	padding: 0.45rem 0.75rem;
	border-radius: 8px;
	font-weight: 600;
	color: var(--muted);
	cursor: pointer;
	/* Interactivity enhancements */
	user-select: none;
	touch-action: manipulation;
	transition: all 0.2s ease;
	-webkit-tap-highlight-color: transparent;
}

.nav-link.active {
	background: var(--primary);
	color: var(--surface);
}

.nav-actions {
	display: flex;
	gap: 0.5rem;
	align-items: center;
	/* Interactivity enhancements */
	scroll-behavior: smooth;
	touch-action: pan-x pan-y;
}
.online-badge {
	background: transparent;
	/* default hover background (light theme) exposed as a variable so dark mode can override */
	--nav-logout-hover: rgba(248, 250, 252, 0.9);
	padding: 0.2rem 0.5rem;
	border-radius: 8px;
	background: linear-gradient(
		135deg,
		color-mix(in srgb, var(--accent-blue-start) 12%, transparent),
		color-mix(in srgb, var(--accent-blue-start) 8%, transparent)
	);
	color: var(--text);
	font-weight: 700;
	.nav-logout:hover {
		background: var(--nav-logout-hover);
		transform: translateY(-1px);
	}
	padding: 0;
	list-style: none;
	display: flex;
	gap: 0.4rem;
	flex-wrap: wrap;
	align-items: center;
	font-size: 0.85rem;
	color: var(--text);
}
.online-name {
	background: var(--name-bg);
	padding: 0.15rem 0.4rem;
	border-radius: 6px;
	font-weight: 600;
	color: var(--name-text);
}

/* 管理員顯示為紅色文字或 chip */
.online-name.admin {
	background: var(--admin-bg);
	color: var(--admin-color);
	border: 1px solid color-mix(in srgb, var(--admin-color) 8%, transparent);
}

/* 右側展開面板 */
.online-status {
	position: relative; /* for absolute panel */
	margin-right: 1rem; /* 與導覽列保持距離 */
}
.online-toggle {
	display: inline-flex;
	gap: 0.5rem;
	align-items: center;
	padding: 0.2rem 0.5rem;
	border-radius: 8px;
	background: linear-gradient(135deg, rgba(37, 99, 235, 0.12), rgba(37, 99, 235, 0.08));
	border: none;
	cursor: pointer;
	font-weight: 700;
}
.online-toggle:focus {
	outline: none;
	box-shadow: 0 0 0 3px color-mix(in srgb, var(--accent-blue-start) 12%, transparent);
}
.online-panel {
	position: absolute;
	left: calc(100% + 8px);
	top: 50%;
	transform: translateY(-50%);
	background: var(--surface);
	border: 1px solid var(--border);
	padding: 0.5rem;
	border-radius: 8px;
	box-shadow: var(--card-shadow);
	display: none;
	min-width: 220px;
	z-index: 50;
}
.online-panel.open {
	display: block;
}
.chev {
	font-size: 0.95rem;
	opacity: 0.85;
}
.online-count {
	margin-right: 0.25rem;
}

/* Modal styles for online players */
.online-modal-overlay {
	position: fixed;
	inset: 0;
	background: var(--overlay-backdrop-weak);
	display: flex;
	align-items: center;
	justify-content: center;
	z-index: 90;
}
.online-modal {
	background: var(--surface);
	border-radius: 12px;
	width: min(720px, 90%);
	max-height: 80%;
	overflow: auto;
	box-shadow: var(--card-shadow);
	border: 1px solid var(--border);
}
.online-modal-header {
	display: flex;
	align-items: center;
	justify-content: space-between;
	padding: 0.75rem 1rem;
	border-bottom: 1px solid var(--border);
}
.online-modal-body {
	padding: 0.75rem 1rem;
}
.online-names-list {
	list-style: none;
	margin: 0;
	padding: 0;
	display: flex;
	flex-direction: column;
	gap: 0.5rem;
}
.online-row {
	display: flex;
	align-items: center;
	justify-content: space-between;
	padding: 0.45rem;
	border-radius: 8px;
}
.kick-btn {
	background-image: linear-gradient(135deg, var(--accent-red-start), var(--accent-red-end));
	color: var(--surface);
	border: none;
	padding: 0.35rem 0.6rem;
	border-radius: 6px;
	cursor: pointer;
	font-weight: 700;
}
.kick-btn[disabled] {
	opacity: 0.45;
	cursor: not-allowed;
}
.modal-close {
	background: transparent;
	border: none;
	font-size: 1rem;
	cursor: pointer;
}
.nav-user {
	position: relative;
	display: inline-flex;
	gap: 0.5rem;
	align-items: center;
	padding: 0.25rem 1.1rem 0.25rem 0.5rem; /* add right space for badge */
	border-radius: 8px;
	font-weight: 700;
	cursor: pointer;
	border: none;
	transition: all 0.2s ease;
	min-height: 34px;
}

.nav-user:hover {
	transform: translateY(-1px);
	box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
}

.nav-user .user-name {
	display: inline-block;
	line-height: 1.2;
}

.online-count-badge {
	position: absolute;
	top: -6px;
	right: -6px;
	background: linear-gradient(135deg, #ef4444, #dc2626);
	color: white;
	font-size: 0.7rem;
	font-weight: 700;
	padding: 0.15rem 0.4rem;
	border-radius: 10px;
	min-width: 18px;
	text-align: center;
	box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
	border: 2px solid var(--surface, #fff);
}
.nav-role {
	/* 使用者角色標籤（例如：一般玩家 / 管理員）
	   加回 badge 樣式以提升可見性 */
	font-size: 0.85rem;
	color: var(--surface);
	background: linear-gradient(135deg, var(--accent-yellow-start), var(--accent-yellow-end));
	border-radius: 8px;
	padding: 0.25rem 0.5rem;
	font-weight: 600;
}

/* Role-specific name backgrounds */
.nav-user.player {
	background: linear-gradient(135deg, var(--accent-blue-end), var(--accent-blue-start));
	color: var(--surface);
}
.nav-user.admin {
	background: linear-gradient(135deg, var(--accent-yellow-start), var(--accent-yellow-end));
	color: var(--text);
}

/* Logout button visuals */
.nav-logout {
	display: inline-flex;
	align-items: center;
	gap: 0.5rem;
	padding: 0.4rem 0.7rem;
	border-radius: 10px;
	/* visual tokens for easier theme overrides */
	--nav-logout-bg: transparent;
	--nav-logout-border: color-mix(in srgb, var(--border) 72%, transparent);
	--nav-logout-color: var(--text);
	--nav-logout-hover: color-mix(in srgb, var(--accent-blue-start) 8%, transparent);
	background: var(--nav-logout-bg);
	border: 1px solid var(--nav-logout-border);
	color: var(--nav-logout-color);
	font-weight: 700;
	cursor: pointer;
	transition:
		background 160ms ease,
		box-shadow 160ms ease,
		transform 120ms ease,
		color 160ms ease;
	position: relative;
}
.nav-logout:hover {
	background: var(--nav-logout-hover);
	box-shadow: 0 6px 18px rgba(16, 24, 40, 0.06);
}
.nav-logout:active {
	transform: translateY(0);
}
.nav-logout:focus {
	outline: none;
	box-shadow: 0 0 0 3px color-mix(in srgb, var(--accent-blue-start) 12%, transparent);
}

/* Dark theme overrides for logout button: use a dark surface background and light text for contrast */

:global(html[data-theme='dark']) .nav-logout {
	/* rely on --surface (dark) when available, fall back to a near-black */
	background: color-mix(in srgb, var(--surface, #0b1220) 92%, black 8%);
	border-color: color-mix(in srgb, var(--text, #e6eef8) 8%, transparent);
	color: var(--text, #e6eef8);
	/* override hover variable for dark theme */
	--nav-logout-hover: color-mix(in srgb, var(--surface, #0b1220) 86%, black 14%);
}

:global(html[data-theme='dark']) .nav-logout:focus {
	box-shadow: 0 0 0 3px color-mix(in srgb, var(--accent-blue-start) 10%, transparent);
}

/* Ensure theme toggle sits comfortably next to logout */
.nav-actions .theme-toggle {
	margin-left: 0.5rem;
}

/* =========================================================
   Tabs / Group list (團隊標籤)
   - 用在表單頁上方的分頁式團隊標籤：`團隊 1 ×`、`+ 添加團隊`
   - 放在 nav partial 以便全站共用樣式
*/
.tab.add {
	display: inline-flex;
	align-items: center;
	gap: 0.3rem;
	cursor: pointer;
	padding: 0.28rem 0.5rem; /* smaller vertical padding */
	border-radius: 8px;
	background: linear-gradient(135deg, var(--accent-blue-start), var(--accent-blue-end));
	color: var(--btn-on-accent);
	font-weight: 600;
	border: none;
	font-size: 0.9rem;
}

/* 外層大框：包覆整個標籤列（如 團隊 1 × 團隊 2 × + 添加團隊）
   使用此容器可統一外框、背景與間距，讓區塊在版面上更突出 */
.tabs-wrapper {
	width: 100%;
	display: block;
	padding: 1rem;
	border-radius: 12px;
	border: 1px solid var(--border);
	background: var(--surface);
	box-shadow: var(--card-shadow);
}

/* Tabs container: compact layout with wrapping as fallback */
.tabs {
	display: flex;
	gap: 0.35rem;
	align-items: center;
	flex-wrap: wrap;
	overflow-x: visible;
}

.tab {
	white-space: nowrap;
}
.tab .tab-num {
	display: inline-block;
	font-weight: 700;
}

/* Legacy overflow styles removed - tabs are now compact by default */

/* Legacy overflow styles removed - tabs are now compact by default */

/* Back button - show label only on larger screens */
.tabs .btn .btn-arrow {
	display: inline-block;
}
.tabs .btn .btn-label {
	display: none;
}

@media (min-width: 640px) {
	.tabs .btn .btn-label {
		display: inline-block;
		margin-left: 0.25rem;
	}
}
.tabs.overflowing .btn {
	padding: 0.28rem 0.45rem; /* match compact tab sizing */
}

.tab {
	padding: 0.3rem 0.5rem; /* smaller vertical padding for compact tabs */
	border-radius: 8px;
	font-family: var(--font-sans);
	font-weight: 700;
	font-size: 0.9rem;
	line-height: 1;
	min-width: auto;
}

.tab:hover {
	background: var(--tab-hover-bg);
	color: var(--tab-hover-color);
}

.tab.active {
	background: var(--tab-active-bg);
	color: var(--tab-active-color);
	border-color: var(--tab-active-bg);
}

.tab-close {
	margin-left: 0.25rem;
	font-weight: 700;
	line-height: 1;
	display: inline-flex;
	align-items: center;
	justify-content: center;
	width: 1.1rem;
	height: 1.1rem;
	border-radius: 4px;
	background: transparent;
	color: inherit;
	cursor: pointer;
	font-size: 0.85rem;
}

.tab-close:hover {
	color: var(--accent-red-start);
}

.tab-add {
	display: inline-flex;
	align-items: center;
	gap: 0.3rem;
	cursor: pointer;
	padding: 0.28rem 0.5rem; /* smaller vertical padding */
	border-radius: 8px;
	background: linear-gradient(135deg, var(--accent-blue-start), var(--accent-blue-end));
	color: var(--btn-on-accent);
	font-weight: 600;
	border: none;
	font-size: 0.9rem;
}

/* Back button shown in the tabs area (← 回上頁) */
.tabs .btn {
	/* match .tab sizing so the back button appears identical to tabs */
	padding: 0.28rem 0.6rem; /* same as .tab */
	min-height: 32px;
	border-radius: 8px;
	background: transparent;
	border: 1px solid rgba(15, 23, 42, 0.06);
	color: var(--text);
	font-weight: 700;
	display: inline-flex;
	align-items: center;
	gap: 0.4rem;
	line-height: 1;
	font-size: 0.9rem;
	box-sizing: border-box;
}
.tabs .btn:hover {
	background: var(--tab-hover-bg);
}

/* Make the back button visually distinct when used in dialogs or other areas retain .btn defaults elsewhere */
.tabs .btn[aria-label='回上頁'] {
	box-shadow: none;
}

/* Status-aware tab coloring
   - 招募中: 藍色 (recruit)
   - 已準備: 綠色 (ready)
   - 已出團: 紅色 (done)
   行為：非選取 tab 半透明；被選取的 tab 使用飽和漸層色 */
.tab {
	opacity: 0.75;
	transition:
		background 160ms ease,
		opacity 160ms ease;
	display: inline-flex; /* ensure consistent box model and vertical centering */
	align-items: center;
	gap: 0.3rem; /* reduced spacing between icon/text */
	padding: 0.28rem 0.6rem; /* compact inner padding */
	min-height: 32px; /* reduced height for compact tabs */
	box-sizing: border-box;
	border-radius: 8px; /* keep pill-ish shape */
	line-height: 1;
	font-size: 0.9rem;
}
.tab.active {
	opacity: 1;
}

.tab.recruit {
	background: var(--team-bg);
	color: var(--text);
}
.tab.recruit.active {
	background: linear-gradient(135deg, var(--accent-blue-start), var(--accent-blue-end));
	color: var(--tab-active-color);
	border-color: transparent;
}

.tab.ready {
	background: var(--level-bg);
	color: var(--text);
}
.tab.ready.active {
	background: linear-gradient(135deg, var(--accent-green-start), var(--accent-green-end));
	color: var(--tab-active-color);
	border-color: transparent;
}

.tab.done {
	background: var(--gear-bg);
	color: var(--text);
}
.tab.done.active {
	background: linear-gradient(135deg, var(--accent-red-start), var(--accent-red-end));
	color: var(--tab-active-color);
	border-color: transparent;
}

/* Status select styles (small pill on the right of the row) */
.status-select {
	min-width: auto;
	padding: 0.375rem 0.5rem;
	border-radius: 8px;
	font-weight: 600;
	max-width: 12rem;
	box-sizing: border-box; /* ensure borders don't affect computed height */
}
.status-select.recruit {
	border: 1px solid var(--accent-blue-start);
	background: var(--team-bg);
	color: var(--text);
}
.status-select.ready {
	border: 1px solid var(--accent-green-start);
	background: var(--level-bg);
	color: var(--text);
}
.status-select.done {
	border: 1px solid var(--accent-pink-end);
	background: var(--gear-bg);
	color: var(--text);
}
.status-select {
	display: inline-flex;
	align-items: center;
	min-height: 32px;
	line-height: 1; /* keep consistent text rendering */
}

/* Online users modal styles */
.online-users-modal {
	background: var(--card-bg);
	border-radius: 12px;
	padding: 1.5rem;
	min-width: 400px;
	max-width: 500px;
}

.online-users-modal h3 {
	margin: 0 0 1rem 0;
	color: var(--text);
	font-size: 1.25rem;
	font-weight: 600;
}

.online-users-list {
	display: flex;
	flex-direction: column;
	gap: 0.75rem;
	margin-bottom: 1.5rem;
}

.online-user-item {
	display: flex;
	align-items: center;
	gap: 0.75rem;
	padding: 0.75rem;
	background: var(--surface);
	border-radius: 8px;
	border: 1px solid var(--border);
}

.online-user-item.current-user {
	background: var(--team-bg);
	border-color: var(--accent-blue-start);
}

.online-user-item .user-name {
	flex: 1;
	font-weight: 500;
	color: var(--text);
}

.online-user-item .user-badge {
	padding: 0.25rem 0.75rem;
	border-radius: 6px;
	font-size: 0.875rem;
	font-weight: 600;
	white-space: nowrap;
}

.user-badge.admin-badge {
	background: linear-gradient(135deg, var(--accent-blue-start), var(--accent-blue-end));
	color: white;
}

.user-badge.player-badge {
	background: var(--level-bg);
	color: var(--text);
	border: 1px solid var(--border);
}

.btn-kick {
	background: linear-gradient(135deg, var(--accent-red-start), var(--accent-red-end));
	color: white;
	border: none;
	padding: 0.25rem 0.5rem;
	border-radius: 4px;
	font-size: 0.75rem;
	font-weight: 600;
	cursor: pointer;
	transition:
		opacity 0.2s,
		transform 0.15s;
}

.btn-kick:hover {
	opacity: 0.9;
	transform: translateY(-1px);
}

.btn-kick:active {
	transform: translateY(0);
}

.online-users-info {
	color: var(--text);
	margin: 0 0 0.5rem 0;
}

.online-users-note {
	color: var(--text-muted);
	font-size: 0.875rem;
	margin: 0;
}
